<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Tailscale Mesh VPN Architecture | Claude Diagrams</title>
<meta name=generator content="Hugo 0.121.2"><link rel=stylesheet href=/claude-diagrams/pr-preview/pr-15/css/main.min.6031f18919a5919243f3aef7c58df672be3052a45dd4517b8fc728761fda4de4.css></head><body><main><article class=diagram-single><header class=diagram-header><h1>Tailscale Mesh VPN Architecture</h1><p class=description>Technical diagram showing Tailscale's mesh VPN architecture with control plane, data plane, and DERP relay servers</p><div class=metadata><time>January 23, 2025</time><div class=tags><a href=/claude-diagrams/pr-preview/pr-15/tags/wireguard/ class=tag>#wireguard</a>
<a href=/claude-diagrams/pr-preview/pr-15/tags/mesh-vpn/ class=tag>#mesh-vpn</a>
<a href=/claude-diagrams/pr-preview/pr-15/tags/p2p/ class=tag>#p2p</a>
<a href=/claude-diagrams/pr-preview/pr-15/tags/zero-trust/ class=tag>#zero-trust</a>
<a href=/claude-diagrams/pr-preview/pr-15/tags/derp/ class=tag>#derp</a>
<a href=/claude-diagrams/pr-preview/pr-15/tags/nat-traversal/ class=tag>#nat-traversal</a>
<a href=/claude-diagrams/pr-preview/pr-15/tags/distributed/ class=tag>#distributed</a>
<a href=/claude-diagrams/pr-preview/pr-15/tags/mesh-network/ class=tag>#mesh-network</a>
<a href=/claude-diagrams/pr-preview/pr-15/tags/overlay-network/ class=tag>#overlay-network</a></div></div></header><div class=diagram-container><div class=svg-wrapper><svg width="1200" height="900" viewBox="0 0 1200 900" xmlns="http://www.w3.org/2000/svg"><text x="600" y="35" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="20" font-weight="600" fill="#000">Tailscale Mesh VPN Architecture</text><g id="control-plane"><rect x="450" y="80" width="300" height="100" fill="#e3f2fd" stroke="#000" stroke-width="2" rx="4"/><text x="600" y="110" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="16" font-weight="500" fill="#000">Tailscale Control Plane</text><text x="600" y="130" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="12" fill="#374151">control.tailscale.com</text><text x="600" y="150" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="11" fill="#64748b">• Authentication • Key Exchange</text><text x="600" y="165" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="11" fill="#64748b">• Policy Distribution • DERP Selection</text></g><g id="derp-servers"><g id="derp-us-west"><path d="M150 250l30-20h40l30 20v40l-30 20H180l-30-20z" fill="#f5f5f5" stroke="#000" stroke-width="1"/><text x="200" y="260" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="500" fill="#000">DERP</text><text x="200" y="280" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="12" fill="#374151">US-West</text><text x="200" y="295" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" fill="#64748b">sfo</text></g><g id="derp-eu-central"><path d="M950 250l30-20h40l30 20v40l-30 20H980l-30-20z" fill="#f5f5f5" stroke="#000" stroke-width="1"/><text x="1e3" y="260" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="500" fill="#000">DERP</text><text x="1e3" y="280" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="12" fill="#374151">EU-Central</text><text x="1e3" y="295" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" fill="#64748b">fra</text></g><g id="derp-asia-pacific"><path d="M550 350l30-20h40l30 20v40l-30 20H580l-30-20z" fill="#f5f5f5" stroke="#000" stroke-width="1"/><text x="600" y="360" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="500" fill="#000">DERP</text><text x="600" y="380" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="12" fill="#374151">Asia-Pacific</text><text x="600" y="395" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" fill="#64748b">syd</text></g></g><g id="tailnet-nodes"><g id="laptop-node"><rect x="100" y="500" width="200" height="120" fill="#fff" stroke="#000" stroke-width="2" rx="4"/><text x="200" y="530" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="500" fill="#000">laptop</text><text x="200" y="550" text-anchor="middle" font-family="monospace" font-size="12" fill="#374151">100.64.1.5</text><text x="200" y="570" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="11" fill="#64748b">alice.yak-bebop.ts.net</text><circle cx="270" cy="520" r="8" fill="#4caf50"/><text x="200" y="595" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" fill="#64748b">macOS • WireGuard</text></g><g id="server-node"><rect x="350" y="500" width="200" height="120" fill="#fff" stroke="#2196f3" stroke-width="2" rx="4"/><rect x="360" y="510" width="40" height="20" fill="#2196f3" rx="2"/><text x="380" y="525" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" font-weight="600" fill="#fff">EXIT</text><text x="450" y="530" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="500" fill="#000">server</text><text x="450" y="550" text-anchor="middle" font-family="monospace" font-size="12" fill="#374151">100.64.2.10</text><text x="450" y="570" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="11" fill="#64748b">exit.yak-bebop.ts.net</text><circle cx="520" cy="520" r="8" fill="#4caf50"/><text x="450" y="595" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" fill="#64748b">Linux • Routes: 0.0.0.0/0</text></g><g id="phone-node"><rect x="600" y="500" width="200" height="120" fill="#fff" stroke="#000" stroke-width="2" rx="4"/><text x="700" y="530" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="500" fill="#000">phone</text><text x="700" y="550" text-anchor="middle" font-family="monospace" font-size="12" fill="#374151">100.64.3.8</text><text x="700" y="570" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="11" fill="#64748b">bob.yak-bebop.ts.net</text><circle cx="770" cy="520" r="8" fill="#4caf50"/><text x="700" y="595" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" fill="#64748b">iOS • WireGuard</text></g><g id="subnet-router"><rect x="850" y="500" width="200" height="120" fill="#fff" stroke="#4caf50" stroke-width="2" rx="4"/><rect x="860" y="510" width="50" height="20" fill="#4caf50" rx="2"/><text x="885" y="525" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" font-weight="600" fill="#fff">SUBNET</text><text x="950" y="530" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="500" fill="#000">office-router</text><text x="950" y="550" text-anchor="middle" font-family="monospace" font-size="12" fill="#374151">100.64.4.1</text><text x="950" y="570" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="11" fill="#64748b">office.yak-bebop.ts.net</text><circle cx="1020" cy="520" r="8" fill="#4caf50"/><text x="950" y="595" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" fill="#64748b">Routes: 192.168.1.0/24</text></g></g><g id="office-subnet"><rect x="880" y="680" width="140" height="80" fill="#f5f5f5" stroke="#000" stroke-width="1" rx="4" stroke-dasharray="3,3"/><text x="950" y="705" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="12" font-weight="500" fill="#000">Office Network</text><text x="950" y="725" text-anchor="middle" font-family="monospace" font-size="11" fill="#374151">192.168.1.0/24</text><text x="950" y="745" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" fill="#64748b">Internal Resources</text></g><g id="connections" fill="none"><path d="M2e2 5e2q0-5 0-10V240q0-5 5-5H545q5 0 5-5V180" stroke="#9ca3af" stroke-width="1" stroke-dasharray="2,2"/><path d="M450 5e2q0-5 0-10V340q0-5 5-5H595q5 0 5-5V180" stroke="#9ca3af" stroke-width="1" stroke-dasharray="2,2"/><path d="M7e2 5e2q0-5 0-10V240q0-5-5-5H655q-5 0-5-5V180" stroke="#9ca3af" stroke-width="1" stroke-dasharray="2,2"/><path d="M950 5e2q0-5 0-10V240q0-5-5-5H705q-5 0-5-5V180" stroke="#9ca3af" stroke-width="1" stroke-dasharray="2,2"/><line x1="300" y1="560" x2="350" y2="560" stroke="#000" stroke-width="3" marker-end="url(#arrowhead)"/><text x="325" y="550" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">direct</text><line x1="550" y1="560" x2="600" y2="560" stroke="#000" stroke-width="3" marker-end="url(#arrowhead)"/><text x="575" y="550" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">direct</text><line x1="800" y1="560" x2="850" y2="560" stroke="#000" stroke-width="3" marker-end="url(#arrowhead)"/><text x="825" y="550" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">direct</text><path d="M2e2 620q250 50 5e2.0" stroke="#6b7280" stroke-width="2" stroke-dasharray="5,3" opacity=".6"/><text x="450" y="665" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="10" fill="#6b7280">attempting direct</text><path d="M2e2 5e2q0-1e2.0-190" stroke="#6b7280" stroke-width="1" stroke-dasharray="5,3" opacity=".4"/><path d="M7e2 5e2q-1e2-50-1e2-90" stroke="#6b7280" stroke-width="1" stroke-dasharray="5,3" opacity=".4"/><path d="M950 5e2q50-1e2 50-190" stroke="#6b7280" stroke-width="1" stroke-dasharray="5,3" opacity=".4"/><line x1="950" y1="620" x2="950" y2="680" stroke="#4caf50" stroke-width="3" marker-end="url(#arrowhead-green)"/></g><g id="nat-traversal" transform="translate(100, 720)"><rect x="0" y="0" width="300" height="120" fill="#f5f5f5" stroke="#000" stroke-width="1" rx="4"/><text x="150" y="20" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="600" fill="#000">NAT Traversal Process</text><text x="10" y="40" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">1. DISCO packets via DERP</text><text x="10" y="58" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">2. STUN-like endpoint discovery</text><text x="10" y="76" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">3. Direct WireGuard tunnel</text><text x="10" y="94" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">4. Fallback to DERP relay if needed</text></g><defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#000"/></marker><marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#4caf50"/></marker></defs><g id="legend" transform="translate(450, 720)"><rect x="0" y="0" width="400" height="120" fill="#f5f5f5" stroke="#000" stroke-width="1" rx="4"/><text x="200" y="20" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="600" fill="#000">Connection Types</text><line x1="20" y1="40" x2="60" y2="40" stroke="#000" stroke-width="3"/><text x="70" y="45" font-family="Inter, Arial, sans-serif" font-size="12" fill="#000">Direct WireGuard (encrypted P2P)</text><line x1="20" y1="60" x2="60" y2="60" stroke="#6b7280" stroke-width="2" stroke-dasharray="5,3"/><text x="70" y="65" font-family="Inter, Arial, sans-serif" font-size="12" fill="#000">DERP Relay (encrypted relay)</text><line x1="20" y1="80" x2="60" y2="80" stroke="#9ca3af" stroke-width="1" stroke-dasharray="2,2"/><text x="70" y="85" font-family="Inter, Arial, sans-serif" font-size="12" fill="#000">Control Plane (auth, key exchange)</text><circle cx="30" cy="100" r="8" fill="#4caf50"/><text x="45" y="105" font-family="Inter, Arial, sans-serif" font-size="12" fill="#000">Online/Connected</text></g><g id="features" transform="translate(880, 350)"><rect x="0" y="0" width="280" height="120" fill="#fff" stroke="#000" stroke-width="1" rx="4"/><text x="140" y="20" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-size="14" font-weight="600" fill="#000">Mesh VPN Features</text><text x="10" y="40" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">• True mesh topology (no hub)</text><text x="10" y="58" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">• WireGuard encryption</text><text x="10" y="76" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">• Automatic NAT traversal</text><text x="10" y="94" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">• MagicDNS resolution</text><text x="10" y="112" font-family="Inter, Arial, sans-serif" font-size="11" fill="#000">• ACL-based access control</text></g></svg></div></div><div class=diagram-description><p>This diagram illustrates the architecture of Tailscale&rsquo;s mesh VPN, showing:</p><ul><li>Hybrid control/data plane architecture</li><li>Peer-to-peer WireGuard connections between nodes</li><li>DERP relay servers for NAT traversal fallback</li><li>Centralized coordination server for key exchange and policy distribution</li></ul></div></article><style>.diagram-single{max-width:1200px;margin:0 auto;padding:2rem}.diagram-header{margin-bottom:2rem;text-align:center}.diagram-header h1{font-size:2.5rem;margin-bottom:1rem}.description{font-size:1.2rem;color:var(--text-secondary);margin-bottom:1rem}.metadata{display:flex;justify-content:center;align-items:center;gap:2rem;color:var(--text-secondary);font-size:.9rem}.tags{display:flex;gap:.5rem}.tag{background:var(--bg-secondary);padding:.25rem .75rem;border-radius:9999px;text-decoration:none;color:var(--text-secondary);transition:all .3s}.tag:hover{background:var(--accent);color:#fff}.diagram-container{background:var(--bg-secondary);border-radius:8px;padding:2rem;margin:2rem 0;overflow:auto}.svg-wrapper{display:flex;justify-content:center;align-items:center;min-height:400px}.svg-wrapper svg{max-width:100%;height:auto}.diagram-description{margin-top:2rem;font-size:1.1rem;line-height:1.8}</style></main></body></html>